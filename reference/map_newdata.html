<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function takes a predinfo object and applies (maps) a new data to
this object to check there is consistency between the two. This function is
not usually called directly, but rather within  other functions within the
package, such as pred_predict."><title>Map new data to a predinfo object — map_newdata • predRupdate</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Map new data to a predinfo object — map_newdata"><meta property="og:description" content="This function takes a predinfo object and applies (maps) a new data to
this object to check there is consistency between the two. This function is
not usually called directly, but rather within  other functions within the
package, such as pred_predict."><meta property="og:image" content="https://glenmartin31.github.io/predRupdate/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">predRupdate</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/predRupdate.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/predRupdate_splineIllustration.html">Example of Validating a Model that Includes Spline Terms</a>
    <a class="dropdown-item" href="../articles/predRupdate_technical.html">Technical Background to predRupdate</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/GlenMartin31/predRupdate/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Map new data to a predinfo object</h1>
      <small class="dont-index">Source: <a href="https://github.com/GlenMartin31/predRupdate/blob/HEAD/R/map_newdata.R" class="external-link"><code>R/map_newdata.R</code></a></small>
      <div class="d-none name"><code>map_newdata.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function takes a <code>predinfo</code> object and applies (maps) a new data to
this object to check there is consistency between the two. This function is
not usually called directly, but rather within  other functions within the
package, such as <code>pred_predict</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">map_newdata</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">new_data</span>,</span>
<span>  binary_outcome <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  survival_time <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  event_indicator <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>an object of class "predinfo".</p></dd>


<dt>new_data</dt>
<dd><p>data.frame upon which the prediction model should be applied
(for subsequent validation/model updating/model aggregation).</p></dd>


<dt>binary_outcome</dt>
<dd><p>Character variable giving the name of the column in
<code>new_data</code> that represents the observed binary outcomes (should be
coded 0 and 1 for non-event and event, respectively). Only relevant for
<code>model_type</code>="logistic"; leave as <code>NULL</code> otherwise. Leave as
<code>NULL</code> if <code>new_data</code> does not contain any outcomes.</p></dd>


<dt>survival_time</dt>
<dd><p>Character variable giving the name of the column in
<code>new_data</code> that represents the observed survival times. Only relevant
for <code>model_type</code>="survival"; leave as <code>NULL</code> otherwise. Leave as
<code>NULL</code> if <code>new_data</code> does not contain any survival outcomes.</p></dd>


<dt>event_indicator</dt>
<dd><p>Character variable giving the name of the column in
<code>new_data</code> that represents the observed survival indicator (1 for
event, 0 for censoring). Only relevant for <code>model_type</code>="survival";
leave as <code>NULL</code> otherwise. Leave as <code>NULL</code> if <code>new_data</code>
does not contain any survival outcomes.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>Returns a list of the predinfo object, the new_data, and outcomes.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function maps a new dataset onto a <code>pred_info</code> object. The
new dataset might be a validation dataset (to test the performance of the
existing prediction model) and/or it might be the dataset on which one
wishes to apply model updating methods to revise the model. In any case,
this should be specified in <code>new_data</code> as a data.frame. Each row
should be an observation (e.g. patient) and each variable/column should be
a predictor variable. The predictor variables need to include (as a
minimum) all of the predictor variables that are included in the existing
prediction model (i.e., each of the variable names supplied to
<code><a href="pred_input_info.html">pred_input_info</a></code>, through the <code>model_info</code> parameter,
must match the name of a variables in <code>new_data</code>).</p>
<p>Any factor variables within <code>new_data</code> must be converted to dummy
(0/1) variables before calling this function. <code><a href="dummy_vars.html">dummy_vars</a></code> can
help with this.</p>
<p><code>binary_outcome</code>, <code>survival_time</code> and <code>event_indicator</code> are
used to specify the outcome variable(s) within <code>new_data</code>, if relevant
(use <code>binary_outcome</code> if <code>model_type</code> = "logistic", or use
<code>survival_time</code> and <code>event_indicator</code> if <code>model_type</code> =
"survival"). For example, if validating an existing model, then these
inputs specify the columns of <code>new_data</code> that will be used for
assessing predictive performance of the predictions in the validation
dataset. If <code>new_data</code> does not contain outcomes, then leave these
inputs to the default of <code>NULL</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">#as above, this function is not usually called directly, but an example of</span></span></span>
<span class="r-in"><span><span class="co">#such use is:</span></span></span>
<span class="r-in"><span><span class="va">model1</span> <span class="op">&lt;-</span> <span class="fu"><a href="pred_input_info.html">pred_input_info</a></span><span class="op">(</span>model_type <span class="op">=</span> <span class="st">"logistic"</span>,</span></span>
<span class="r-in"><span>                          model_info <span class="op">=</span> <span class="va">SYNPM</span><span class="op">$</span><span class="va">Existing_logistic_models</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">map_newdata</span><span class="op">(</span>x <span class="op">=</span> <span class="va">model1</span>,</span></span>
<span class="r-in"><span>            new_data <span class="op">=</span> <span class="va">SYNPM</span><span class="op">$</span><span class="va">ValidationData</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,<span class="op">]</span>,</span></span>
<span class="r-in"><span>            binary_outcome <span class="op">=</span> <span class="st">"Y"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $modelinfo</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Formula: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ~Age + SexM + Smoking_Status + Diabetes + Creatinine</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x55836c57e748&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Coefficients: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Intercept        Age      SexM Smoking_Status  Diabetes Creatinine</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 -3.995452 0.01150886 0.2673809      0.7511888 0.5230999  0.5781238</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $PredictionData</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Age SexM Smoking_Status Diabetes Creatinine      ETime Status Y</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  48.68421    1              0        0  0.4847849 5.00000000      0 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  51.62041    1              0        0  1.0440606 0.02824273      1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  51.37057    0              0        0  0.6682031 5.00000000      0 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  50.97524    1              0        1  1.2498120 2.77747285      1 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  52.47209    1              0        0  1.4186517 5.00000000      0 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  43.69205    1              0        0  0.6271332 5.00000000      0 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  49.92449    1              0        0  0.5669761 2.99792812      1 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  42.56161    0              0        0  1.7943725 3.19669111      1 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  57.96719    0              0        0  1.2668577 2.78071011      1 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 51.18527    0              0        0  0.2766686 0.29270868      1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Outcomes</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 0 1 0 0 0 0 0 0 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Glen P. Martin, David Jenkins, Matthew Sperrin.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

